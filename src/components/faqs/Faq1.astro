---
import type { HTMLAttributes } from 'astro/types'
// Foundation components
import Text from '@/components/fundations/elements/Text.astro'
import Button from '@/components/fundations/elements/Button.astro'
import Wrapper from '@/components/fundations/containers/Wrapper.astro'
// Icons
import Plus from '@/components/fundations/icons/Plus.astro'

/**
 * Single FAQ item
 */
export interface FaqItem {
	/** Unique identifier */
	id: string
	/** The question text */
	question: string
	/** The answer text */
	answer: string
}

/**
 * Props for the Faq1 component
 */
interface Props extends Omit<HTMLAttributes<'section'>, 'class'> {
	/** Optional label above headline */
	label?: string
	/** Main headline */
	headline: string
	/** Highlighted text in headline */
	highlightedText?: string
	/** Description below headline */
	description?: string
	/** FAQ items to display */
	faqs: FaqItem[]
	/** CTA button text */
	ctaText?: string
	/** CTA button href */
	ctaHref?: string
	/** AOS animation type */
	animation?: string
	/** AOS animation duration */
	animationDuration?: string
	/** Additional CSS classes */
	class?: string
}

const {
	label,
	headline,
	highlightedText,
	description,
	faqs,
	ctaText,
	ctaHref,
	animation = 'fade-up',
	animationDuration = '600',
	class: className,
	...rest
} = Astro.props
---

<section class:list={[className]} {...rest}>
	<Wrapper
		variant="standard"
		class="grid grid-cols-1 gap-y-12 py-24 lg:grid-cols-4 lg:gap-y-24"
	>
		<div
			class="before:bg-nextnode-500 relative pl-2 before:absolute before:-top-6 before:-left-2 before:h-6 before:w-px lg:pr-8"
			data-aos={animation}
			data-aos-duration={animationDuration}
		>
			{
				label && (
					<Text tag="span" variant="textSM" class="text-slate-600">
						{label}
					</Text>
				)
			}
			<Text
				tag="h2"
				variant="displayMD"
				class="font-display mt-6 tracking-tight text-slate-900 lg:text-balance"
			>
				{headline}
				{
					highlightedText && (
						<span class="text-nextnode-500">{highlightedText}</span>
					)
				}
			</Text>
			{
				description && (
					<Text
						tag="p"
						variant="textBase"
						class="mt-2 text-balance text-slate-900"
					>
						{description}
					</Text>
				)
			}
			{
				ctaText && ctaHref && (
					<div class="mt-8 flex">
						<Button
							isLink
							size="sm"
							variant="default"
							href={ctaHref}
							title={ctaText}
							aria-label={ctaText}
							class="w-auto justify-center"
						>
							{ctaText}
						</Button>
					</div>
				)
			}
		</div>
		<div class="flex flex-col gap-8 lg:col-span-3">
			{
				faqs.map((faq, index) => (
					<details
						class="group cursor-pointer"
						data-aos={animation}
						data-aos-duration={String(
							Number(animationDuration) + index * 100,
						)}
					>
						<summary class="relative flex w-full items-start justify-between text-left text-lg text-slate-900 select-none">
							<span class="pr-8">{faq.question}</span>
							<Plus
								size="sm"
								class="shrink-0 transform duration-300 group-open:-rotate-45 group-open:text-slate-600"
								aria-hidden="true"
							/>
						</summary>
						<div class="px-4 py-4 text-base text-slate-600">
							{faq.answer}
						</div>
					</details>
				))
			}
		</div>
	</Wrapper>
</section>
