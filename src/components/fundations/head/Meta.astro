---
/**
 * Meta.astro - Meta tags component for Open Graph and Twitter Cards
 *
 * Provides essential meta tags for social sharing and SEO.
 * For more advanced SEO features, use the Seo.astro component with @astrolib/seo.
 *
 * Usage:
 * ```astro
 * <Meta
 *   title="Page Title"
 *   description="Page description"
 *   ogImage="/images/og.jpg"
 *   twitterCard="summary_large_image"
 * />
 * ```
 */

export interface OpenGraphImage {
	/** URL of the image */
	url: string
	/** Image width in pixels */
	width?: number
	/** Image height in pixels */
	height?: number
	/** Alt text for the image */
	alt?: string
	/** MIME type of the image */
	type?: string
}

export interface OpenGraphProps {
	/** Open Graph title (defaults to page title) */
	title?: string
	/** Open Graph description (defaults to meta description) */
	description?: string
	/** Open Graph type (defaults to 'website') */
	type?: 'website' | 'article' | 'profile' | 'book' | 'music' | 'video'
	/** Canonical URL for the page */
	url?: string
	/** Site name */
	siteName?: string
	/** Locale (defaults to 'en_US') */
	locale?: string
	/** Images for sharing */
	images?: OpenGraphImage[]
}

export interface TwitterProps {
	/** Twitter card type */
	card?: 'summary' | 'summary_large_image' | 'app' | 'player'
	/** Twitter @username of the website */
	site?: string
	/** Twitter @username of the content creator */
	creator?: string
	/** Twitter title (defaults to og:title or page title) */
	title?: string
	/** Twitter description (defaults to og:description or meta description) */
	description?: string
	/** Twitter image URL (defaults to og:image) */
	image?: string
	/** Alt text for Twitter image */
	imageAlt?: string
}

export interface Props {
	/** Page title */
	title?: string
	/** Meta description for SEO */
	description?: string
	/** Keywords for SEO (comma-separated) */
	keywords?: string
	/** Author name or company */
	author?: string
	/** Theme color for mobile browsers */
	themeColor?: string
	/** Robots meta directive */
	robots?: string
	/** Open Graph properties */
	openGraph?: OpenGraphProps
	/** Twitter Card properties */
	twitter?: TwitterProps
}

const {
	title,
	description,
	keywords,
	author,
	themeColor = '#ffffff',
	robots = 'index, follow',
	openGraph,
	twitter,
} = Astro.props

// Merge defaults for Open Graph
const og = {
	title: openGraph?.title ?? title,
	description: openGraph?.description ?? description,
	type: openGraph?.type ?? 'website',
	url: openGraph?.url,
	siteName: openGraph?.siteName,
	locale: openGraph?.locale ?? 'en_US',
	images: openGraph?.images ?? [],
}

// Merge defaults for Twitter
const tw = {
	card: twitter?.card ?? 'summary_large_image',
	site: twitter?.site,
	creator: twitter?.creator,
	title: twitter?.title ?? og.title,
	description: twitter?.description ?? og.description,
	image: twitter?.image ?? og.images[0]?.url,
	imageAlt: twitter?.imageAlt ?? og.images[0]?.alt,
}
---

{/* Basic Meta Tags */}
{title && <title>{title}</title>}
{description && <meta name="description" content={description} />}
{keywords && <meta name="keywords" content={keywords} />}
{author && <meta name="author" content={author} />}

{/* Theme and Browser */}
<meta name="theme-color" content={themeColor} />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="robots" content={robots} />
<meta name="googlebot" content={robots} />

{/* Open Graph / Facebook */}
<meta property="og:type" content={og.type} />
{og.url && <meta property="og:url" content={og.url} />}
{og.title && <meta property="og:title" content={og.title} />}
{og.description && <meta property="og:description" content={og.description} />}
{og.siteName && <meta property="og:site_name" content={og.siteName} />}
<meta property="og:locale" content={og.locale} />
{
	og.images.map(image => (
		<>
			<meta property="og:image" content={image.url} />
			{image.width && (
				<meta property="og:image:width" content={String(image.width)} />
			)}
			{image.height && (
				<meta
					property="og:image:height"
					content={String(image.height)}
				/>
			)}
			{image.alt && <meta property="og:image:alt" content={image.alt} />}
			{image.type && (
				<meta property="og:image:type" content={image.type} />
			)}
		</>
	))
}

{/* Twitter Card */}
<meta name="twitter:card" content={tw.card} />
{tw.site && <meta name="twitter:site" content={tw.site} />}
{tw.creator && <meta name="twitter:creator" content={tw.creator} />}
{tw.title && <meta name="twitter:title" content={tw.title} />}
{tw.description && <meta name="twitter:description" content={tw.description} />}
{tw.image && <meta name="twitter:image" content={tw.image} />}
{tw.imageAlt && <meta name="twitter:image:alt" content={tw.imageAlt} />}
