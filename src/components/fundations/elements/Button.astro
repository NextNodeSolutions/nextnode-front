---
/**
 * Button.astro - Versatile button component with multiple variants and sizes
 *
 * Supports both button and anchor elements, with icon-only mode.
 * Colors are mapped to NextNode brand tokens via CSS custom properties.
 */

import type { HTMLAttributes } from 'astro/types'

// prettier-ignore
export type ButtonVariant = 'default' | 'accent' | 'orange' | 'muted' | 'link' | 'none'
// prettier-ignore
export type ButtonSize = 'xxs' | 'xs' | 'sm' | 'base' | 'md' | 'lg' | 'xl'
// prettier-ignore
export type ButtonGap = 'xs' | 'sm' | 'base' | 'md' | 'lg'

interface Props extends HTMLAttributes<'button'> {
	/** Visual style variant */
	variant?: ButtonVariant
	/** Size of the button */
	size?: ButtonSize
	/** Gap between button content (when not icon-only) */
	gap?: ButtonGap
	/** Render as icon-only button (uses square dimensions) */
	iconOnly?: boolean
	/** Render as anchor tag instead of button */
	isLink?: boolean
	/** URL for anchor (requires isLink=true) */
	href?: string
	/** Additional CSS classes */
	class?: string
}

const {
	variant = 'default',
	size = 'base',
	gap,
	iconOnly = false,
	isLink = false,
	href,
	class: className,
	...rest
} = Astro.props

// Default button - dark gradient
const defaultClass = [
	'text-white',
	'bg-linear-to-t',
	'from-base-800',
	'to-base-600',
	'hover:from-base-600',
	'hover:to-base-800',
	'focus:outline-base-600',
]

// Accent button - brand color gradient (NextNode sky blue)
const accentClass = [
	'text-white',
	'bg-linear-to-t',
	'from-accent-700',
	'to-accent-500',
	'hover:from-accent-500',
	'hover:to-accent-700',
	'focus:outline-accent-500',
]

// Orange button - CTA accent color gradient
const orangeClass = [
	'text-white',
	'bg-linear-to-t',
	'from-orange-600',
	'to-orange-500',
	'hover:from-orange-500',
	'hover:to-orange-400',
	'focus:outline-orange-500',
]

// Muted button - subtle dark gradient
const mutedClass = [
	'text-white',
	'bg-linear-to-t',
	'from-base-950',
	'to-base-900',
	'hover:from-base-900',
	'hover:to-base-950',
	'focus:outline-white',
]

// Size configurations
const sizes: Record<ButtonSize, string[]> = {
	xxs: ['h-7.5', 'px-4', 'py-2', 'text-xs'],
	xs: ['h-8', 'px-4', 'py-2', 'text-xs'],
	sm: ['h-9', 'px-4', 'py-2', 'text-xs'],
	base: ['h-10', 'px-6', 'py-3', 'text-base'],
	md: ['h-11', 'px-6', 'py-3', 'text-md'],
	lg: ['h-12', 'px-6', 'py-3', 'text-lg'],
	xl: ['h-14', 'px-6', 'py-3', 'text-base'],
}

// Icon-only size configurations (square dimensions)
const iconSizes: Record<ButtonSize, string[]> = {
	xxs: ['size-7.5', 'py-2', 'text-xs'],
	xs: ['size-8', 'text-xs'],
	sm: ['size-9', 'text-sm'],
	base: ['size-10', 'text-sm'],
	md: ['size-11', 'text-base'],
	lg: ['size-12', 'text-lg'],
	xl: ['size-14', 'text-lg'],
}

// Gap configurations
const gapMap: Record<ButtonGap, string[]> = {
	xs: ['gap-2'],
	sm: ['gap-4'],
	base: ['gap-8'],
	md: ['gap-10'],
	lg: ['gap-12'],
}

const variantClass: Record<ButtonVariant, string[]> = {
	default: defaultClass,
	accent: accentClass,
	orange: orangeClass,
	muted: mutedClass,
	link: [],
	none: [],
}

const sizeClass = iconOnly ? iconSizes[size] : sizes[size]
const gapClass = !iconOnly && gap ? gapMap[gap] : []
const additionalClasses = className ? className.split(' ') : []

const baseClass =
	variant === 'link'
		? []
		: [
				'flex',
				'justify-center',
				'text-center',
				'rounded-full',
				'font-medium',
				'shadow-dimensional',
				'items-center',
				'duration-500',
				'ease-in-out',
				'transition-colors',
				'focus:outline-2',
				'outline-offset-4',
			]
---

{
	isLink ? (
		<a
			href={href}
			class:list={[
				...baseClass,
				...variantClass[variant],
				...sizeClass,
				...gapClass,
				...additionalClasses,
			]}
			{...rest}
		>
			{iconOnly ? (
				<slot name="icon" />
			) : (
				<>
					<slot name="left-icon" />
					<slot />
					<slot name="right-icon" />
				</>
			)}
		</a>
	) : (
		<button
			class:list={[
				...baseClass,
				...variantClass[variant],
				...sizeClass,
				...gapClass,
				...additionalClasses,
			]}
			{...rest}
		>
			{iconOnly ? (
				<slot name="icon" />
			) : (
				<>
					<slot name="left-icon" />
					<slot />
					<slot name="right-icon" />
				</>
			)}
		</button>
	)
}
