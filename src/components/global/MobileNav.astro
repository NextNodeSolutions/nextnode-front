---
/**
 * MobileNav.astro - Mobile navigation component
 *
 * Slide-down mobile menu with CSS grid animation.
 * Uses Menu/Close icons for toggle button.
 */

import Button from '@/components/fundations/elements/Button.astro'
import Menu from '@/components/fundations/icons/Menu.astro'
import Close from '@/components/fundations/icons/Close.astro'

/**
 * Navigation link definition
 */
export interface NavLink {
	label: string
	href: string
}

interface Props {
	/** Navigation links to display */
	navLinks: NavLink[]
}

const { navLinks } = Astro.props
---

<div class="md:hidden">
	<!-- Mobile Menu Toggle -->
	<Button
		iconOnly
		size="sm"
		variant="default"
		id="menu-toggle"
		aria-label="Toggle main menu"
	>
		<Menu slot="icon" size="sm" id="menu-icon" />
		<Close slot="icon" size="sm" class="hidden" id="close-icon" />
	</Button>

	<!-- Mobile Menu - Curtain Animation -->
	<nav
		id="mobile-menu"
		class="absolute top-full right-4 left-4 mt-8 grid grid-rows-[0fr] transition-[grid-template-rows] duration-300 ease-in-out"
	>
		<div class="overflow-hidden">
			<div class="bg-base-900 flex flex-col gap-2 rounded-xl p-8">
				{
					navLinks.map(link => (
						<a
							title={link.label}
							aria-label={link.label}
							href={link.href}
							class="hover:text-base-400 text-xl text-white transition-colors duration-200"
						>
							{link.label}
						</a>
					))
				}
			</div>
		</div>
	</nav>
</div>

<script>
	document.addEventListener('DOMContentLoaded', () => {
		const menuToggle = document.getElementById('menu-toggle')
		const mobileMenu = document.getElementById('mobile-menu')
		const menuIcon = document.getElementById('menu-icon')
		const closeIcon = document.getElementById('close-icon')
		let isMenuOpen = false

		function toggleMenu() {
			if (!mobileMenu || !menuIcon || !closeIcon) return

			isMenuOpen = !isMenuOpen
			if (isMenuOpen) {
				mobileMenu.classList.remove('grid-rows-[0fr]')
				mobileMenu.classList.add('grid-rows-[1fr]')
			} else {
				mobileMenu.classList.remove('grid-rows-[1fr]')
				mobileMenu.classList.add('grid-rows-[0fr]')
			}
			menuIcon.classList.toggle('hidden', isMenuOpen)
			closeIcon.classList.toggle('hidden', !isMenuOpen)
		}

		function handleResize() {
			if (!mobileMenu || !menuIcon || !closeIcon) return

			if (window.innerWidth >= 768 && isMenuOpen) {
				isMenuOpen = false
				mobileMenu.classList.remove('grid-rows-[1fr]')
				mobileMenu.classList.add('grid-rows-[0fr]')
				menuIcon.classList.remove('hidden')
				closeIcon.classList.add('hidden')
			}
		}

		menuToggle?.addEventListener('click', toggleMenu)
		window.addEventListener('resize', handleResize)
	})
</script>
