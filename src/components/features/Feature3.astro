---
/**
 * Feature3.astro - Two-column section with feature grid and code block
 *
 * A section component that displays a 2x2 feature grid on the left
 * alongside a syntax-highlighted code block on the right.
 * Different layout than Feature1 (code cards per feature) and Feature2 (sticky sidebar + 3-col grid).
 */

import type { HTMLAttributes } from 'astro/types'
import { Code } from 'astro:components'
import Text from '@/components/fundations/elements/Text.astro'
import Wrapper from '@/components/fundations/containers/Wrapper.astro'

export interface Feature3CodeBlock {
	/** Code content to display */
	code: string
	/** Programming language for syntax highlighting */
	lang?: 'js' | 'ts' | 'jsx' | 'tsx' | 'json' | 'html' | 'css' | 'shell'
}

export interface Feature3Item {
	/** Unique identifier for the feature */
	id: string
	/** Short tagline above the title */
	tagline: string
	/** Feature title */
	title: string
	/** Feature description text */
	description: string
}

interface Props extends HTMLAttributes<'section'> {
	/** Label text above the headline */
	label?: string
	/** Main headline text */
	headline: string
	/** Highlighted/muted text portion of headline */
	highlightedText?: string
	/** Description paragraph text */
	description?: string
	/** Array of feature items to display in 2x2 grid */
	features: Feature3Item[]
	/** Code block to display on the right side */
	codeBlock?: Feature3CodeBlock
	/** AOS animation type */
	animation?: string
	/** AOS animation duration in milliseconds */
	animationDuration?: string
	/** Additional CSS classes */
	class?: string
}

const {
	label,
	headline,
	highlightedText,
	description,
	features,
	codeBlock,
	animation = 'fade-up',
	animationDuration = '1500',
	class: className,
	...rest
} = Astro.props
---

<section class:list={[className]} {...rest}>
	<Wrapper
		variant="standard"
		class="grid grid-cols-1 gap-y-12 py-12 lg:grid-cols-4 lg:gap-y-24 lg:pt-42"
	>
		<div class="lg:col-span-2">
			<div>
				{
					label && (
						<Text tag="span" variant="textSM" class="text-white">
							{label}
						</Text>
					)
				}
				<Text
					tag="h3"
					variant="displayMD"
					class="font-display mt-12 text-balance text-white"
				>
					{headline}
					{
						highlightedText && (
							<span class="text-nextnode-400 block">
								{highlightedText}
							</span>
						)
					}
				</Text>
				{
					description && (
						<Text
							tag="p"
							variant="textBase"
							class="mt-2 text-balance text-white"
						>
							{description}
						</Text>
					)
				}
			</div>
			<div
				class="mt-24 grid grid-cols-1 gap-y-12 md:grid-cols-2 lg:col-span-4"
			>
				{
					features.map(item => (
						<div class="before:bg-white">
							<div class="relative px-4 before:absolute before:top-0 before:left-0 before:h-6 before:w-px before:bg-white after:absolute after:top-8 after:bottom-0 after:left-0 after:w-px">
								<div class="relative">
									<Text
										tag="span"
										variant="textSM"
										class="text-base-500"
									>
										{item.tagline}
									</Text>
									<Text
										tag="h3"
										variant="textBase"
										class="mt-2 font-medium text-white"
									>
										{item.title}
									</Text>
								</div>
								<Text
									tag="p"
									variant="textSM"
									class="text-base-500 mt-2 text-pretty"
								>
									{item.description}
								</Text>
							</div>
						</div>
					))
				}
			</div>
		</div>
		{
			codeBlock && (
				<div class="relative mt-8 lg:col-span-2 lg:mt-0">
					<div
						data-aos={animation}
						data-aos-duration={animationDuration}
					>
						<div class="border-base-900 bg-base-950 border border-b-0 border-l-white px-4 py-2">
							<div class="flex items-center gap-1">
								<div class="outline-base-600 size-2 rounded-full outline" />
								<div class="outline-base-700 size-2 rounded-full outline" />
								<div class="outline-base-800 size-2 rounded-full outline" />
							</div>
						</div>
						<Code
							class="scrollbar-hide border-base-900 border border-y border-r border-l p-8 text-xs lg:border-l-0"
							code={codeBlock.code}
							lang={codeBlock.lang ?? 'js'}
							theme="css-variables"
						/>
					</div>
				</div>
			)
		}
	</Wrapper>
</section>
