---
/**
 * Work.astro - Step-by-step process section
 *
 * A section component that displays how a product/service works
 * through numbered steps with descriptions and an optional visual.
 */

import type { HTMLAttributes } from 'astro/types'
import Text from '@/components/fundations/elements/Text.astro'
import Wrapper from '@/components/fundations/containers/Wrapper.astro'

export interface WorkStep {
	/** Unique identifier for the step */
	id: string
	/** Step number (displayed prominently) */
	step: number
	/** Step title */
	title: string
	/** Step description */
	description: string
}

interface Props extends HTMLAttributes<'section'> {
	/** Section label/eyebrow text */
	label?: string
	/** Main headline */
	headline: string
	/** Optional highlighted portion of headline */
	highlightedText?: string
	/** Section description */
	description?: string
	/** Array of process steps */
	steps: WorkStep[]
	/** Optional image URL for visual */
	imageUrl?: string
	/** Image alt text */
	imageAlt?: string
	/** AOS animation type */
	animation?: string
	/** AOS animation duration in milliseconds */
	animationDuration?: string
	/** Additional CSS classes */
	class?: string
}

const {
	label,
	headline,
	highlightedText,
	description,
	steps,
	imageUrl,
	imageAlt = 'How it works illustration',
	animation = 'fade-up',
	animationDuration = '1500',
	class: className,
	...rest
} = Astro.props
---

<section class:list={[className]} {...rest}>
	<Wrapper variant="standard">
		<div class="border-base-900 border-x px-8 py-16 lg:py-24">
			<div class="max-w-3xl lg:mx-auto lg:text-center">
				{
					label && (
						<Text
							tag="span"
							variant="textSM"
							class="text-accent-400 mb-4 block font-medium tracking-widest uppercase"
							data-aos={animation}
							data-aos-duration={animationDuration}
						>
							{label}
						</Text>
					)
				}
				<Text
					tag="h2"
					variant="displayLG"
					class="font-display leading-none font-semibold text-white"
					data-aos={animation}
					data-aos-duration={animationDuration}
				>
					{headline}
					{
						highlightedText && (
							<span class="text-nextnode-500">
								{' '}
								{highlightedText}
							</span>
						)
					}
				</Text>
				{
					description && (
						<Text
							tag="p"
							variant="textLG"
							class="text-base-400 mt-6 text-balance"
							data-aos={animation}
							data-aos-duration={animationDuration}
						>
							{description}
						</Text>
					)
				}
			</div>

			<div class="mt-16 grid gap-12 lg:grid-cols-2 lg:gap-16">
				<div class="space-y-8">
					{
						steps.map((step, index) => (
							<div
								class="border-base-800 relative flex gap-6 border-l pl-8"
								data-aos={animation}
								data-aos-duration={String(
									Number(animationDuration) + index * 200,
								)}
							>
								<div class="bg-nextnode-500 absolute -left-4 flex size-8 items-center justify-center rounded-full font-semibold text-white">
									{step.step}
								</div>
								<div>
									<Text
										tag="h3"
										variant="textLG"
										class="font-display font-semibold text-white"
									>
										{step.title}
									</Text>
									<Text
										tag="p"
										variant="textBase"
										class="text-base-400 mt-2"
									>
										{step.description}
									</Text>
								</div>
							</div>
						))
					}
				</div>

				{
					imageUrl && (
						<div
							class="bg-base-900 relative h-80 overflow-hidden rounded-xl lg:h-auto"
							data-aos={animation}
							data-aos-duration={animationDuration}
						>
							<img
								src={imageUrl}
								alt={imageAlt}
								class="size-full object-cover"
							/>
						</div>
					)
				}
			</div>
		</div>
	</Wrapper>
</section>
